---
name: grootfs
templates:
  bin/btrfs-setup.erb:                      bin/btrfs-setup
  bin/overlay-xfs-setup.erb:                bin/overlay-xfs-setup
  bin/utils.erb:                            bin/utils
  bin/pre-start.erb:                        bin/pre-start
  config/grootfs_config.yml.erb:            config/grootfs_config.yml
  config/privileged_grootfs_config.yml.erb: config/privileged_grootfs_config.yml
  certs/blobstore.crt.erb:                  certs/blobstore.crt
  certs/blobstore.cert.erb:                 certs/blobstore.cert
  certs/blobstore.key.erb:                  certs/blobstore.key

packages:
  - idmapper
  - btrfs-progs
  - xfs-progs
  - grootfs

consumes:
  - name: rootless_link
    type: garden_rootless_link
    optional: true

properties:
  grootfs.driver:
    description: "Filesystem driver to use."
    default: overlay-xfs
  grootfs.log_level:
    description: "Log level for grootfs - can be debug, info, error or fatal."
    default: info
  grootfs.dropsonde_port:
    description: "Local metron agent's port."
    default: 3457
  grootfs.insecure_docker_registry_list:
    description: "A list of IP:PORT tuples that we allow pulling docker images from using self-signed certificates."
    default: []
  grootfs.cache_size_bytes:
    description: "Limit of space consumed by unused filesystem layers kept in the cache."
    default: 10737418240
  grootfs.skip_mount:
    description: "Do not mount image root filesystem automatically, just return the mount information."
    default: false

  grootfs.blobstore.tls.cert:
    description: "PEM-encoded TLS certificate that can be used for client auth"
  grootfs.blobstore.tls.key:
    description: "PEM-encoded TLS client key"
  grootfs.blobstore.tls.ca_cert:
    description: "PEM-encoded TLS client CA certificate for droplet download"
